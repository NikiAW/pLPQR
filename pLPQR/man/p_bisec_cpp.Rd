% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{p_bisec_cpp}
\alias{p_bisec_cpp}
\title{Bisection Method for Probability Calculation}
\usage{
p_bisec_cpp(theta, y, X, bf, n_it = 20L)
}
\arguments{
\item{theta}{Numeric matrix of estimated parameters (p x K), where p is the number
of covariates and K is the number of basis functions.}

\item{y}{Numeric vector of response values (length n).}

\item{X}{Numeric design matrix (n x p) containing covariates.}

\item{bf}{R function that computes the K-dimensional basis functions of tau.
Should take a single numeric argument (tau) and return a numeric vector.}

\item{n_it}{Integer specifying the maximum number of iterations for the bisection
algorithm. Default is 20.}
}
\value{
Numeric vector of probabilities (length n) in the range [0, 1] representing
  the estimated quantile levels for each observation.
}
\description{
This function implements an efficient bisection algorithm to compute probabilities
for quantile regression models. It performs a two-phase search:
a coarse search for rapid convergence followed by a fine search for precision.
}
\details{
The algorithm works as follows:
\itemize{
  \item \strong{Phase 1 (Coarse search, iterations 2-10)}: Uses large steps for
        rapid convergence to the approximate solution.
  \item \strong{Phase 2 (Fine search, iterations 11-n_it)}: Uses progressively
        smaller steps for high precision, with caching of basis function evaluations.
}

The function employs caching to avoid repeated evaluations of the basis functions
at the same tau values, improving computational efficiency.
}
\examples{
\donttest{
# Example usage
set.seed(123)
n <- 100
p <- 3
K <- 2

# Generate sample data
theta <- matrix(rnorm(p * K), nrow = p, ncol = K)
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
y <- rnorm(n)

# Define basis function
bf <- function(tau) {
  return(c(1, qnorm(tau)))
}

# Compute probabilities
probabilities <- p_bisec_cpp(theta, y, X, bf, n_it = 20)
head(probabilities)
}

}
\references{
\itemize{
  \item Sottile, G., and Frumento, P. (2023). Parametric estimation of non-crossing quantile functions. Statistical Modelling, 23 (2), 173-195.
}
}
