% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{simdata_cpp}
\alias{simdata_cpp}
\title{Simulate longitudinal data by a specified correlation matrix}
\usage{
simdata_cpp(thetahat, X, nsub, bf, index, id, spcor)
}
\arguments{
\item{thetahat}{Numeric matrix of estimated parameters (p x K), where p is the number
of covariates and K is the number of basis functions.}

\item{X}{Numeric design matrix (n x p) containing covariates for all observations.}

\item{nsub}{Integer specifying the number of subjects in the longitudinal data.}

\item{bf}{R function that computes the K-dimensional basis functions of tau.
Should take a single numeric argument (tau) and return a numeric vector.}

\item{index}{Integer vector indicating the time ordering within subjects.}

\item{id}{Integer vector identifying subject membership for each observation.}

\item{spcor}{Numeric matrix (m x m) specifying the spatial/temporal correlation
structure between time points, where m is the number of time points per subject.}
}
\value{
A list containing the following components:
\describe{
  \item{y}{Numeric vector of simulated response values (length n).}
  \item{x}{Numeric design matrix, same as input X.}
  \item{tau_ij}{Numeric vector of quantile levels (length n) used for data generation.}
  \item{nsub}{Integer, number of subjects.}
  \item{index}{Integer vector, time ordering within subjects.}
  \item{id}{Integer vector, subject identifiers.}
}
}
\description{
This function generates simulated longitudinal data using a copula-based approach
for composite quantile regression models. It creates correlated response data
with specified correlation structure across time points within subjects.
}
\details{
The function implements the following data generation process:
\enumerate{
  \item \strong{Copula Generation}: Uses Cholesky decomposition of the correlation
        matrix to generate correlated normal samples, which are transformed to
        uniform [0,1] variables via the normal CDF.
  \item \strong{Quantile Levels}: The uniform variables serve as quantile levels
        (tau_ij) that introduce within-subject correlation.
  \item \strong{Response Generation}: For each observation, computes the basis
        functions at the generated quantile level, applies the parameter matrix
        to get time-varying coefficients, and generates the response as a linear
        combination of covariates and coefficients.
}

This approach ensures that the simulated data maintains the specified correlation
structure across time points within each subject, making it suitable for
longitudinal data analysis.
}
\examples{
\donttest{
# Example: Simulate longitudinal data with 50 subjects and 3 time points
set.seed(123)
nsub <- 50
m <- 3  # time points per subject
n <- nsub * m
p <- 2  # number of covariates
K <- 2  # number of basis functions

# Parameter matrix
thetahat <- matrix(c(1.0, 0.5, 0.3, 0.8), nrow = p, ncol = K)

# Design matrix
X <- cbind(1, matrix(rnorm(n * (p-1)), nrow = n, ncol = p-1))

# Basis function
bf <- function(tau) {
  return(c(1, qnorm(tau)))
}

# Correlation structure (compound symmetry) using base R
rho <- 0.6
spcor <- (1 - rho) * diag(m) + rho * matrix(1, m, m)

# Subject identifiers and time indices
id <- rep(1:nsub, each = m)
index <- rep(1:m, nsub)

# Generate data
sim_data <- simdata_cpp(thetahat, X, nsub, bf, index, id, spcor)

# Check the structure
str(sim_data)
head(sim_data$y)
}

}
